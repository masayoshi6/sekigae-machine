<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>åº§å¸­è¡¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ - å¸­æ›¿ãˆã‚¢ãƒ—ãƒª</title>
  <style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        background-color: rgba(255,255,255,0.95);
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        backdrop-filter: blur(10px);
    }

    .header {
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 3px solid #667eea;
    }

    .header h1 {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-size: 2.5em;
        margin: 0 0 10px 0;
        animation: titleGlow 2s ease-in-out infinite alternate;
    }

    @keyframes titleGlow {
        from { filter: drop-shadow(0 0 5px rgba(102, 126, 234, 0.3)); }
        to { filter: drop-shadow(0 0 15px rgba(118, 75, 162, 0.5)); }
    }

    .header p {
        color: #666;
        font-size: 16px;
        margin: 0;
    }

    .config-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .config-card {
        background: linear-gradient(135deg, #e8f5ff 0%, #f0f8ff 100%);
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        border: 2px solid transparent;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .config-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
        transition: 0.5s;
    }

    .config-card:hover::before {
        left: 100%;
    }

    .config-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.2);
        border-color: #667eea;
    }

    .config-value {
        font-size: 2.5em;
        font-weight: bold;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 5px;
    }

    .config-label {
        color: #666;
        font-weight: 500;
    }

    .classroom-container {
        background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
        padding: 30px;
        border-radius: 15px;
        margin-bottom: 30px;
        box-shadow: inset 0 2px 10px rgba(0,0,0,0.05);
    }

    .classroom-header {
        text-align: center;
        margin-bottom: 20px;
    }

    .classroom-header h3 {
        font-size: 1.5em;
        margin: 0 0 10px 0;
        color: #333;
    }

    .blackboard {
        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        color: white;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        margin-bottom: 30px;
        font-size: 18px;
        font-weight: bold;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        position: relative;
        overflow: hidden;
    }

    .blackboard::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
        animation: blackboardShine 3s infinite;
    }

    @keyframes blackboardShine {
        0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }

    .seating-grid {
        display: grid;
        gap: 15px;
        justify-content: center;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }

    .seat {
        width: 60px;
        height: 60px;
        border: 3px solid #ddd;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 12px;
        text-align: center;
        transition: all 0.3s ease;
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }

    .seat::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: radial-gradient(circle, rgba(102, 126, 234, 0.3) 0%, transparent 70%);
        transition: all 0.3s ease;
        border-radius: 50%;
        transform: translate(-50%, -50%);
    }

    .seat:hover::before {
        width: 200px;
        height: 200px;
    }

    .seat-occupied {
        background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        color: white;
        border-color: #4CAF50;
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
    }

    .seat-empty {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        color: #6c757d;
        border-color: #dee2e6;
    }

    .seat:hover {
        transform: scale(1.1) rotate(2deg);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .row-label {
        font-weight: bold;
        color: #667eea;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
    }

    .column-label {
        font-weight: bold;
        color: #667eea;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
    }

    .legend {
        display: flex;
        justify-content: center;
        gap: 30px;
        margin: 20px 0;
        padding: 20px;
        background: rgba(255,255,255,0.8);
        border-radius: 12px;
        backdrop-filter: blur(5px);
    }

    .legend-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 15px;
        border-radius: 8px;
        background: rgba(255,255,255,0.9);
        transition: transform 0.2s ease;
    }

    .legend-item:hover {
        transform: scale(1.05);
    }

    .legend-seat {
        width: 25px;
        height: 25px;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: bold;
    }

    .status-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .status-card {
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        transition: all 0.3s ease;
        border: 2px solid transparent;
    }

    .status-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }

    .status-card.success {
        background: linear-gradient(135deg, #e8f5e8 0%, #f0fff0 100%);
        border-color: #4CAF50;
    }

    .status-card.warning {
        background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
        border-color: #ffc107;
    }

    .button-group {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
        flex-wrap: wrap;
    }

    .btn {
        padding: 15px 30px;
        border: none;
        border-radius: 25px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        text-decoration: none;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        position: relative;
        overflow: hidden;
    }

    .btn::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255,255,255,0.3);
        transition: all 0.3s ease;
        border-radius: 50%;
        transform: translate(-50%, -50%);
    }

    .btn:hover::before {
        width: 300px;
        height: 300px;
    }

    .btn-primary {
        background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        color: white;
        box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
    }

    .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
    }

    .btn-secondary {
        background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
        color: white;
        box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
    }

    .btn-secondary:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(108, 117, 125, 0.4);
    }

    .btn-info {
        background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
        color: white;
        box-shadow: 0 5px 15px rgba(23, 162, 184, 0.3);
    }

    .btn-info:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(23, 162, 184, 0.4);
    }

    .animation-controls {
        text-align: center;
        margin-bottom: 20px;
    }

<!-- ã€€ã€€åº§å¸­ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã§åº§å¸­ï¼‘ãƒã‚¹ï¼‘ãƒã‚¹ã‚’ã‚†ã£ãã‚Šæ‹¡å¤§ç¸®å°ã•ã›ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆï¼‘ï¼ï¼’å€æ‹¡å¤§ç¸®å°ï¼‰-->
    .animate-seats {
        animation: seatPulse 2s ease-in-out infinite alternate;
    }

    @keyframes seatPulse {
        0% { transform: scale(1); }
        100% { transform: scale(1.2); }
    }

    @media (max-width: 768px) {
        .container {
            margin: 10px;
            padding: 20px;
        }

        .config-summary {
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .seat {
            width: 45px;
            height: 45px;
            font-size: 10px;
        }

        .button-group {
            flex-direction: column;
            gap: 15px;
        }

        .legend {
            flex-direction: column;
            gap: 15px;
        }
    }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>ğŸ¯ åº§å¸­è¡¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h1>
    <p>æ–°ã—ã„åº§å¸­é…ç½®ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ç¢ºèªã§ãã¾ã™</p>
  </div>

  <!-- è¨­å®šã‚µãƒãƒªãƒ¼ -->
  <div class="config-summary">
    <div class="config-card">
      <div class="config-value" id="previewRows">6</div>
      <div class="config-label">è¡Œæ•°</div>
    </div>
    <div class="config-card">
      <div class="config-value" id="previewColumns">5</div>
      <div class="config-label">åˆ—æ•°</div>
    </div>
    <div class="config-card">
      <div class="config-value" id="previewTotalSeats">30</div>
      <div class="config-label">ç·åº§å¸­æ•°</div>
    </div>
    <div class="config-card">
      <div class="config-value" id="previewStudents">25</div>
      <div class="config-label">ç”Ÿå¾’æ•°</div>
    </div>
    <div class="config-card">
      <div class="config-value" id="previewEmptySeats">5</div>
      <div class="config-label">ç©ºå¸­æ•°</div>
    </div>
  </div>

  <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚«ãƒ¼ãƒ‰ -->
  <div class="status-cards">
    <div class="status-card success" id="statusCard">
      <h4>âœ… é…ç½®å¯èƒ½ã§ã™</h4>
      <p>å…¨ã¦ã®ç”Ÿå¾’ã‚’åº§å¸­ã«é…ç½®ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<br>
        <span id="emptySeatsInfo">5å¸­ã®ç©ºå¸­ãŒã‚ã‚Šã¾ã™ã€‚</span></p>
    </div>
  </div>

  <!-- æ•™å®¤ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
  <div class="classroom-container">
    <div class="classroom-header">
      <h3>ğŸ“š æ•™å®¤ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</h3>
    </div>

    <div class="blackboard">
      ğŸ–¤ é»’æ¿ ğŸ–¤
    </div>

    <div class="legend">
      <div class="legend-item">
        <div class="legend-seat seat-occupied">ç”Ÿ</div>
        <span>ç”Ÿå¾’ã®åº§å¸­</span>
      </div>
      <div class="legend-item">
        <div class="legend-seat seat-empty">ç©º</div>
        <span>ç©ºå¸­</span>
      </div>
    </div>

    <div class="animation-controls">
      <button type="button" class="btn btn-info" onclick="toggleAnimation()">
        âœ¨ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ ON/OFF
      </button>
    </div>

    <div class="seating-grid" id="seatingGrid">
      <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
    </div>
  </div>

  <div class="button-group">
    <button type="button" class="btn btn-primary" onclick="confirmAndSave()">
      ğŸ’¾ ã“ã®è¨­å®šã§ä¿å­˜
    </button>
    <button type="button" class="btn btn-secondary" onclick="goBack()">
      â¬…ï¸ è¨­å®šã«æˆ»ã‚‹
    </button>
    <button type="button" class="btn btn-info" onclick="randomizeSeats()">
      ğŸ² ãƒ©ãƒ³ãƒ€ãƒ é…ç½®ã‚’è©¦ã™
    </button>
  </div>
</div>

<script>
  // è¨­å®šå€¤ï¼ˆå®Ÿéš›ã«ã¯ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å—ã‘å–ã‚‹ï¼‰
  let currentConfig = {
      rows: 6,
      columns: 5,
      totalStudents: 25
  };

  // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰è¨­å®šã‚’å–å¾—ï¼ˆå®Ÿè£…ä¾‹ï¼‰
  // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰è¨­å®šã‚’å–å¾—
function getConfigFromUrl() {
    const urlParams = new URLSearchParams(window.location.search);

    // è¡Œæ•°ã®å–å¾—
    if (urlParams.get('rows')) {
        currentConfig.rows = parseInt(urlParams.get('rows'));
    }

    // åˆ—æ•°ã®å–å¾—
    if (urlParams.get('columns')) {
        currentConfig.columns = parseInt(urlParams.get('columns'));
    }

    // ç”Ÿå¾’æ•°ã®å–å¾—ï¼ˆæ–°ã—ãè¿½åŠ ï¼‰
    if (urlParams.get('students')) {
        currentConfig.totalStudents = parseInt(urlParams.get('students'));
    }

    updateDisplay();
}

  function updateDisplay() {
      const totalSeats = currentConfig.rows * currentConfig.columns;
      const emptySeats = totalSeats - currentConfig.totalStudents;

      document.getElementById('previewRows').textContent = currentConfig.rows;
      document.getElementById('previewColumns').textContent = currentConfig.columns;
      document.getElementById('previewTotalSeats').textContent = totalSeats;
      document.getElementById('previewStudents').textContent = currentConfig.totalStudents;
      document.getElementById('previewEmptySeats').textContent = Math.max(0, emptySeats);

      // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚«ãƒ¼ãƒ‰ã®æ›´æ–°
      const statusCard = document.getElementById('statusCard');
      const emptySeatsInfo = document.getElementById('emptySeatsInfo');

      if (emptySeats < 0) {
          statusCard.className = 'status-card warning';
          statusCard.innerHTML = `
              <h4>âš ï¸ åº§å¸­æ•°ãŒä¸è¶³ã—ã¦ã„ã¾ã™</h4>
              <p>ç™»éŒ²ç”Ÿå¾’æ•°(${currentConfig.totalStudents}äºº)ã«å¯¾ã—ã¦åº§å¸­æ•°ãŒ${Math.abs(emptySeats)}å¸­ä¸è¶³ã—ã¦ã„ã¾ã™ã€‚<br>
              è¡Œæ•°ã¾ãŸã¯åˆ—æ•°ã‚’å¢—ã‚„ã—ã¦ãã ã•ã„ã€‚</p>
          `;
      } else {
          statusCard.className = 'status-card success';
          emptySeatsInfo.textContent = emptySeats === 0 ? 'æº€å¸­ã§ã™ã€‚' : `${emptySeats}å¸­ã®ç©ºå¸­ãŒã‚ã‚Šã¾ã™ã€‚`;
      }

      generateSeatingGrid();
  }

  function generateSeatingGrid() {
      const grid = document.getElementById('seatingGrid');
      const totalSeats = currentConfig.rows * currentConfig.columns;

      // ã‚°ãƒªãƒƒãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®š
      grid.style.gridTemplateColumns = `30px repeat(${currentConfig.columns}, 1fr)`;
      grid.style.gridTemplateRows = `30px repeat(${currentConfig.rows}, 1fr)`;

      grid.innerHTML = '';

      // åˆ—ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ 
      grid.appendChild(createEmptyCell()); // å·¦ä¸Šã®ç©ºã‚»ãƒ«
      for (let col = 1; col <= currentConfig.columns; col++) {
          const label = document.createElement('div');
          label.className = 'column-label';
          label.textContent = col;
          grid.appendChild(label);
      }

      // è¡Œã‚’ç”Ÿæˆ
      for (let row = 1; row <= currentConfig.rows; row++) {
          // è¡Œãƒ©ãƒ™ãƒ«
          const rowLabel = document.createElement('div');
          rowLabel.className = 'row-label';
          rowLabel.textContent = row;
          grid.appendChild(rowLabel);

          // åº§å¸­
          for (let col = 1; col <= currentConfig.columns; col++) {
              const seatNumber = (row - 1) * currentConfig.columns + col;
              const seat = document.createElement('div');
              seat.className = 'seat';
              seat.dataset.seatNumber = seatNumber;

              if (seatNumber <= currentConfig.totalStudents) {
                  seat.classList.add('seat-occupied');
                  seat.innerHTML = `<div>ç”Ÿå¾’<br>${seatNumber}</div>`;
              } else {
                  seat.classList.add('seat-empty');
                  seat.innerHTML = '<div>ç©ºå¸­</div>';
              }

              seat.addEventListener('click', () => toggleSeat(seat));
              grid.appendChild(seat);
          }
      }
  }

  function createEmptyCell() {
      const cell = document.createElement('div');
      return cell;
  }

  function toggleSeat(seat) {
      if (seat.classList.contains('seat-occupied')) {
          seat.classList.remove('seat-occupied');
          seat.classList.add('seat-empty');
          seat.innerHTML = '<div>ç©ºå¸­</div>';
      } else {
          seat.classList.remove('seat-empty');
          seat.classList.add('seat-occupied');
          const seatNum = seat.dataset.seatNumber;
          seat.innerHTML = `<div>ç”Ÿå¾’<br>${seatNum}</div>`;
      }
  }

  let animationEnabled = false;
  function toggleAnimation() {
      const seats = document.querySelectorAll('.seat');
      animationEnabled = !animationEnabled;

      seats.forEach(seat => {
          if (animationEnabled) {
              seat.classList.add('animate-seats');
          } else {
              seat.classList.remove('animate-seats');
          }
      });
  }

  function randomizeSeats() {
      const seats = document.querySelectorAll('.seat');
      const occupiedCount = currentConfig.totalStudents;
      const totalSeats = seats.length;

      // å…¨å¸­ã‚’ç©ºå¸­ã«ãƒªã‚»ãƒƒãƒˆ
      seats.forEach((seat, index) => {
          seat.classList.remove('seat-occupied', 'seat-empty');
          seat.classList.add('seat-empty');
          seat.innerHTML = '<div>ç©ºå¸­</div>';
      });

      // ãƒ©ãƒ³ãƒ€ãƒ ã«åº§å¸­ã‚’é¸ã‚“ã§ç”Ÿå¾’ã‚’é…ç½®
      const occupiedSeats = new Set();
      let studentCount = 1;

      while (occupiedSeats.size < Math.min(occupiedCount, totalSeats)) {
          const randomIndex = Math.floor(Math.random() * totalSeats);
          if (!occupiedSeats.has(randomIndex)) {
              occupiedSeats.add(randomIndex);
              const seat = seats[randomIndex];
              seat.classList.remove('seat-empty');
              seat.classList.add('seat-occupied');
              seat.innerHTML = `<div>ç”Ÿå¾’<br>${studentCount}</div>`;
              studentCount++;
          }
      }
  }

  function confirmAndSave() {
      if (confirm('ã“ã®åº§å¸­é…ç½®ã§ä¿å­˜ã—ã¾ã™ã‹ï¼Ÿ\nä¿å­˜ã™ã‚‹ã¨ç¾åœ¨ã®åº§å¸­è¡¨ãŒæ–°ã—ã„è¨­å®šã§ç½®ãæ›ã‚ã‚Šã¾ã™ã€‚')) {
          // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã“ã“ã§ã‚µãƒ¼ãƒãƒ¼ã«è¨­å®šã‚’é€ä¿¡
          alert('åº§å¸­è¡¨è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸï¼\næ–°ã—ã„å¸­æ›¿ãˆã‚’é–‹å§‹ã§ãã¾ã™ã€‚');
          window.location.href = '/seating/setup';
      }
  }

  function goBack() {
      history.back();
  }

  // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®åˆæœŸåŒ–
  document.addEventListener('DOMContentLoaded', function() {
      getConfigFromUrl();
      updateDisplay();

      // ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆè¦ç´ ï¼šåº§å¸­ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸæ™‚ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
      document.addEventListener('click', function(e) {
          if (e.target.closest('.seat')) {
              createClickEffect(e.pageX, e.pageY);
          }
      });
  });

  function createClickEffect(x, y) {
      const effect = document.createElement('div');
      effect.style.position = 'fixed';
      effect.style.left = x + 'px';
      effect.style.top = y + 'px';
      effect.style.width = '20px';
      effect.style.height = '20px';
      effect.style.background = 'radial-gradient(circle, #667eea, transparent)';
      effect.style.borderRadius = '50%';
      effect.style.pointerEvents = 'none';
      effect.style.zIndex = '9999';
      effect.style.animation = 'clickEffect 0.6s ease-out forwards';

      document.body.appendChild(effect);

      setTimeout(() => {
          document.body.removeChild(effect);
      }, 600);
  }

  // CSS ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’JavaScriptã§è¿½åŠ 
  const style = document.createElement('style');
  style.textContent = `
      @keyframes clickEffect {
          0% { transform: scale(1) translate(-50%, -50%); opacity: 1; }
          100% { transform: scale(5) translate(-50%, -50%); opacity: 0; }
      }
  `;
  document.head.appendChild(style);
</script>
</body>
</html>